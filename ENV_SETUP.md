# ç¯å¢ƒå˜é‡é…ç½®æŒ‡å—

## ğŸ“ é…ç½®ä½ çš„é’±åŒ…åœ°å€

### 1. Foundry ç¯å¢ƒå˜é‡

ç¼–è¾‘ `packages/foundry/.env`ï¼š

```bash
# Bob çš„çœŸå®é’±åŒ…ï¼ˆè¦è¯æ˜çš„åœ°å€ï¼‰
# è¿™ä¸ªåœ°å€ä¼šè¢«æ··åœ¨ 32 ä¸ªåœ°å€ä¸­ï¼Œä¿æŒéšç§
BOB_REAL_ADDRESS=0xä½ çš„åœ°å€

# Bob çš„ä»£ç†é’±åŒ…ï¼ˆå‘é€é“¾ä¸Šäº¤æ˜“ï¼‰
# ç”¨äºåˆ›å»ºå®ä¾‹ç­‰æ“ä½œï¼Œå¯ä»¥æš´éœ²
BOB_PROXY_ADDRESS=0xä½ çš„å°å·åœ°å€

# Alice çš„åœ°å€ï¼ˆéªŒè¯è€…ï¼‰
# ç”¨äºæ¼”ç¤ºéªŒè¯æµç¨‹
ALICE_ADDRESS=0xå¦ä¸€ä¸ªåœ°å€
```

### 2. Next.js ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

ç¼–è¾‘ `packages/nextjs/.env.local`ï¼š

```bash
# å¦‚æœéœ€è¦å‰ç«¯ä¹Ÿä½¿ç”¨è¿™äº›åœ°å€
NEXT_PUBLIC_BOB_REAL_ADDRESS=0x...
NEXT_PUBLIC_BOB_PROXY_ADDRESS=0x...
NEXT_PUBLIC_ALICE_ADDRESS=0x...
```

---

## ğŸ¬ ä½¿ç”¨ä½ è‡ªå·±çš„åœ°å€è¿›è¡Œ Demo

### æ–¹æ³• 1ï¼šä¿®æ”¹ .env æ–‡ä»¶

```bash
cd ~/zk-flex

# ç¼–è¾‘ .env
nano packages/foundry/.env

# ä¿®æ”¹è¿™ä¸‰ä¸ªåœ°å€ä¸ºä½ çš„åœ°å€ï¼š
BOB_REAL_ADDRESS=0xä½ çš„ä¸»é’±åŒ…
BOB_PROXY_ADDRESS=0xä½ çš„å°å·
ALICE_ADDRESS=0xæœ‹å‹çš„åœ°å€

# ä¿å­˜é€€å‡º
```

### æ–¹æ³• 2ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡è¿è¡Œ

```bash
export BOB_REAL_ADDRESS=0xä½ çš„åœ°å€
export BOB_PROXY_ADDRESS=0xå°å·åœ°å€
export ALICE_ADDRESS=0xæœ‹å‹åœ°å€

# è¿è¡Œ Demo
cd packages/foundry
forge script script/DemoSimple.s.sol \
  --fork-url http://localhost:8545 \
  --broadcast
```

---

## ğŸ” åœ°å€ç”¨é€”è¯´æ˜

### Bob_real

```
ç”¨é€”ï¼šè¦è¯æ˜çš„é’±åŒ…åœ°å€
ç‰¹ç‚¹ï¼š
  - æŒæœ‰å¤§é¢èµ„äº§ï¼ˆå¦‚ 15,000 ETHï¼‰
  - ä¼šè¢«æ··åœ¨ 32 ä¸ªåœ°å€ä¸­ï¼ˆä½ç½® 15ï¼‰
  - åœ¨é“¾ä¸Šä¸ä¼šæš´éœ²æ˜¯ Bob çš„åœ°å€
  - åªåœ¨ç”Ÿæˆ ZK è¯æ˜æ—¶ä½¿ç”¨ï¼ˆæµè§ˆå™¨æœ¬åœ°ï¼‰

å®‰å…¨æ€§ï¼š
  âœ… ä¸ä¼šåœ¨é“¾ä¸Šå‘é€ä»»ä½•äº¤æ˜“
  âœ… åªæ˜¯è¢«åŠ¨åœ°å‡ºç°åœ¨åœ°å€æ± ä¸­
  âœ… å’Œå…¶ä»– 31 ä¸ªåœ°å€æ— æ³•åŒºåˆ†
```

### Bob_proxy

```
ç”¨é€”ï¼šä»£ç†é’±åŒ…ï¼Œå‘é€é“¾ä¸Šäº¤æ˜“
ç‰¹ç‚¹ï¼š
  - ä½™é¢è¾ƒå°‘ï¼ˆå¦‚ 100 ETHï¼Œä»…å¤Ÿ gasï¼‰
  - ç”¨äºåˆ›å»ºå®ä¾‹ç­‰é“¾ä¸Šæ“ä½œ
  - å¯ä»¥å…¬å¼€ï¼Œæ— æ‰€è°“

å®‰å…¨æ€§ï¼š
  âœ… å³ä½¿æš´éœ²ä¹Ÿæ²¡å…³ç³»
  âœ… ä¸ Bob_real æ— æ³•å…³è”
  âœ… åªæ˜¯æ“ä½œè´¦æˆ·
```

### Alice

```
ç”¨é€”ï¼šéªŒè¯è€…åœ°å€
ç‰¹ç‚¹ï¼š
  - ç”¨äºæ¼”ç¤ºéªŒè¯æµç¨‹
  - å®é™…ä½¿ç”¨æ—¶å¯ä»¥æ˜¯ä»»ä½•äºº
  
å®‰å…¨æ€§ï¼š
  âœ… åªè°ƒç”¨ view å‡½æ•°ï¼ˆå…è´¹ï¼‰
  âœ… ä¸ä¼šæš´éœ² Bob çš„ä¿¡æ¯
```

---

## ğŸ¯ Demo è„šæœ¬çš„åœ°å€å¤„ç†

### DemoSimple.s.sol

è„šæœ¬ä¼šï¼š

1. **ä» .env è¯»å–åœ°å€**
   ```solidity
   address bobReal = vm.envOr("BOB_REAL_ADDRESS", defaultAddress);
   ```

2. **ç»™åœ°å€å‘é€æµ‹è¯• ETH**ï¼ˆä»…æœ¬åœ°é“¾ï¼‰
   ```solidity
   vm.deal(bobReal, 15000 ether);
   ```

3. **ç”Ÿæˆé’±åŒ…æ± **ï¼ˆ31 ä¸ªå…¬å¼€åœ°å€ + Bob_realï¼‰
   ```
   [0] Vitalik
   [1] Binance
   [2] Kraken
   ...
   [15] Bob_realï¼ˆä½ çš„åœ°å€ï¼‰â† éšè—åœ¨è¿™é‡Œ
   ...
   [31] ç”Ÿæˆçš„åœ°å€
   ```

4. **ä½¿ç”¨ Bob_proxy åˆ›å»ºå®ä¾‹**
   ```
   äº¤æ˜“å‘é€è€…ï¼šBob_proxy
   äº¤æ˜“æ•°æ®ï¼š32 ä¸ªåœ°å€ï¼ˆåŒ…å« Bob_realï¼‰
   ```

---

## ğŸ§ª æµ‹è¯•ä¸åŒåœºæ™¯

### åœºæ™¯ 1ï¼šä½¿ç”¨é»˜è®¤åœ°å€ï¼ˆAnvil è´¦æˆ·ï¼‰

```bash
# ä¸ä¿®æ”¹ .envï¼Œç›´æ¥è¿è¡Œ
forge script script/DemoSimple.s.sol \
  --fork-url http://localhost:8545 \
  --broadcast
```

### åœºæ™¯ 2ï¼šä½¿ç”¨ä½ è‡ªå·±çš„åœ°å€

```bash
# 1. ä¿®æ”¹ packages/foundry/.env

# 2. è¿è¡Œ
forge script script/DemoSimple.s.sol \
  --fork-url http://localhost:8545 \
  --broadcast
```

### åœºæ™¯ 3ï¼šä¸´æ—¶æµ‹è¯•å…¶ä»–åœ°å€

```bash
export BOB_REAL_ADDRESS=0xä¸´æ—¶åœ°å€

forge script script/DemoSimple.s.sol \
  --fork-url http://localhost:8545 \
  --broadcast
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### æœ¬åœ°é“¾ vs æµ‹è¯•ç½‘

**æœ¬åœ°é“¾ï¼ˆAnvilï¼‰**ï¼š
- âœ… å¯ä»¥ä½¿ç”¨ vm.deal ä»»æ„å‘é€ ETH
- âœ… å¯ä»¥ä½¿ç”¨ä»»ä½•åœ°å€
- âœ… é€‚åˆ Demo æ¼”ç¤º

**æµ‹è¯•ç½‘ï¼ˆSepoliaï¼‰**ï¼š
- âŒ ä¸èƒ½ä½¿ç”¨ vm.deal
- âš ï¸ éœ€è¦åœ°å€æœ‰çœŸå®çš„ ETH
- âš ï¸ éœ€è¦ä» faucet è·å–æµ‹è¯•å¸

### éšç§æé†’

```
Bob_real åœ°å€ä¼šï¼š
  âœ… å‡ºç°åœ¨é’±åŒ…æ± å‚æ•°ä¸­ï¼ˆå…¬å¼€ï¼‰
  âœ… ä½†æ··åœ¨ 31 ä¸ªå…¶ä»–åœ°å€ä¸­
  âœ… é“¾ä¸Šæ— æ³•åŒºåˆ†æ˜¯ Bob çš„

Bob_proxy åœ°å€ä¼šï¼š
  âœ… ä½œä¸ºäº¤æ˜“å‘é€è€…ï¼ˆå…¬å¼€ï¼‰
  âœ… ä½†è¿™ä¸é‡è¦ï¼ˆæ˜¯ä»£ç†è´¦æˆ·ï¼‰

æ‰€ä»¥ï¼š
  âœ… ä½¿ç”¨çœŸå®åœ°å€æ˜¯å®‰å…¨çš„
  âœ… éšç§å¾—åˆ°ä¿æŠ¤
```

---

## ğŸ¯ å¿«é€Ÿé…ç½®å‘½ä»¤

```bash
# åˆ›å»º .env æ–‡ä»¶
cat > packages/foundry/.env << 'EOF'
BOB_REAL_ADDRESS=0xä½ çš„ä¸»é’±åŒ…åœ°å€
BOB_PROXY_ADDRESS=0xä½ çš„å°å·åœ°å€
ALICE_ADDRESS=0xæœ‹å‹çš„åœ°å€
ETH_KEYSTORE_ACCOUNT=
EOF

# è¿è¡Œ Demo
yarn chain  # Terminal 1
# ç­‰é“¾å¯åŠ¨...
cd packages/foundry
forge script script/DemoSimple.s.sol \
  --fork-url http://localhost:8545 \
  --broadcast
```

---

**ç°åœ¨è„šæœ¬ä¼šè‡ªåŠ¨ä½¿ç”¨ä½ çš„åœ°å€è¿›è¡Œ Demoï¼** âœ…

