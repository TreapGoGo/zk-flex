# ZK Flex - 运行指南

> **你的地址**：
> - Bob_real:  `0x15AfABaA426334636008Bc15805760716E8b5c5E`
> - Bob_proxy: `0xBA699556d41CD93e794952Bf1476ce9069b1EA03`
> - Alice:     `0x332772fce634D38cdfC649beE923AF52c9b6a2E5`

---

## 🚀 3 个终端，3 个命令

### 终端 1: 启动链

```bash
cd ~/ethshanghai/zk-flex
yarn chain
```

**等待这行输出**：
```
Listening on 127.0.0.1:8545
```

**✅ 看到这行后，链就启动了！保持这个终端运行。**

---

### 终端 2: 部署合约（等链启动 5 秒后）

```bash
cd ~/ethshanghai/zk-flex/packages/foundry

# 设置环境变量（使用你的地址）
export BOB_REAL_ADDRESS=0x15AfABaA426334636008Bc15805760716E8b5c5E
export BOB_PROXY_ADDRESS=0xBA699556d41CD93e794952Bf1476ce9069b1EA03
export ALICE_ADDRESS=0x332772fce634D38cdfC649beE923AF52c9b6a2E5

# 1. 部署合约
forge script script/Deploy.s.sol \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \
  --rpc-url http://localhost:8545 \
  --broadcast

# 看到：
# WealthProofRegistry deployed at: 0x9fE46...

# 2. 生成 TypeScript ABIs（重要！）
node scripts-js/generateTsAbis.js

# 看到：
# ✅ Updated TypeScript contract definition file

# 3. （可选）运行 Demo 脚本创建实例并发钱
forge script script/DemoSimple.s.sol \
  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \
  --rpc-url http://localhost:8545 \
  --broadcast
```

**应该看到**（使用你的真实地址）：
```
==================================================
          ZK FLEX DEMO - FULL WALKTHROUGH        
==================================================

Demo Addresses:
  Bob_real: 0x15AfABaA426334636008Bc15805760716E8b5c5E    ← 你的！
  Bob_proxy: 0xBA699556d41CD93e794952Bf1476ce9069b1EA03   ← 你的！
  Alice: 0x332772fce634D38cdfC649beE923AF52c9b6a2E5       ← Alice！

[0/6] Setup: Funding wallets...
      Bob_real funded: 0x9965... - 15,000 ETH
      ...

[1/6] Deploying contracts...
      Registry deployed: 0x5b73...
      Verifier deployed: 0xC7f2...

[2/6] Bob creates wallet pool instance...
      Instance created: 0xdaE9...

...

Instance: 0x...（你的实例地址）← 记下这个！
```

**✅ 成功！记下 Instance 地址。**

---

### 终端 3: 启动前端（等 ABI 生成完成）

```bash
cd ~/ethshanghai/zk-flex
yarn start
```

**等待**：
```
ready - started server on 0.0.0.0:3000
```

**✅ 打开浏览器**：http://localhost:3000

**⚠️ 重要**：
- 如果前端已经在运行，按 `Ctrl+C` 停止
- 重新运行 `yarn start` 加载新的合约地址

---

## 🎉 完成！现在你有：

```
✅ 本地链运行（Terminal 1）
✅ 合约已部署（Terminal 2 输出）
✅ 前端运行（Terminal 3）
✅ Instance 地址（用于前端）

可以访问：
- Landing: http://localhost:3000
- Bob: http://localhost:3000/zk-flex/bob
- Alice: http://localhost:3000/zk-flex/alice
```

---

## ⚠️ 如果遇到问题

### "Enter keystore password"

**不要输入！** 按 `Ctrl+C` 停止，然后：

```bash
# 确认 .env 没有 keystore 配置
cat packages/foundry/.env

# 应该只有 3 行地址配置，没有 KEYSTORE

# 重新运行命令
```

### "Connection refused"

**链没启动！** 

```bash
# 回到 Terminal 1，确认看到：
# Listening on 127.0.0.1:8545

# 测试连接：
curl http://localhost:8545

# 应该返回 JSON 数据
```

---

## 🎬 Hackathon 演示时

### 提前准备（3 分钟）

1. ✅ 运行上面 3 个命令
2. ✅ 打开浏览器到 http://localhost:3000
3. ✅ 保持 3 个终端可见

### Pitch 时（2 分钟）

1. **展示前端**（30秒）
2. **展示 Terminal 2 输出**（30秒）- 指向 "32 addresses" "Bob hidden"
3. **技术讲解**（60秒）- PPT + 架构图

---

**这个指南保证能跑通！** ✅

